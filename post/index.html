<!DOCTYPE html>
<html lang="en-US">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    <meta name="twitter:card" content="summary"/>
    
        <meta name="twitter:image" content="http://liushengxian.github.io/http://misanya-1252867445.cossh.myqcloud.com/sky.jpg"/>
    



<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content="Somebody has to win，so why not，why not be me ."/>

    <meta name="twitter:site" content="@your_twitter"/>



  	<meta property="og:title" content=" Posts &middot;  Misanya&#39;s Blog" />
  	<meta property="og:site_name" content="Misanya&#39;s Blog" />
  	<meta property="og:url" content="http://liushengxian.github.io/post/" />

    
    <meta property="og:type" content="website" />
    

    <title>
       Posts &middot;  Misanya&#39;s Blog
    </title>

    <meta name="description" content="Somebody has to win，so why not，why not be me ." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="http://liushengxian.github.io/images/favicon.ico">
	  <link rel="apple-touch-icon" href="http://liushengxian.github.io/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="http://liushengxian.github.io/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="http://liushengxian.github.io/css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />


    
        <link href="http://feeds.feedburner.com/..." rel="alternate" type="application/rss+xml" title="Misanya&#39;s Blog" />
    
    <meta name="generator" content="Hugo 0.78.1" />

    <link rel="canonical" href="http://liushengxian.github.io/post/" />

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-86921642-1', 'auto');
      ga('send', 'pageview');

    </script>
    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://liushengxian.github.io/">Home</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://liushengxian.github.io/about">About me</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://liushengxian.github.io/reading-list">Reading List</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="http://feeds.feedburner.com/...">Subscribe</a> </div>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




	 
  <header class="main-header tag-head" style="background-image: url(http://misanya-1252867445.cossh.myqcloud.com/sky.jpg)">
  

    <nav class="main-nav overlay clearfix">
      
        <a class="blog-logo" href="http://liushengxian.github.io/"><img src="http://liushengxian.github.io/images/home.png" alt="Home" /></a>
      
      
          <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
      
    </nav>
    <div class="vertical">
        <div class="main-header-content inner">
            <h1 class="page-title">Posts</h1>
            <h2 class="page-description">
                
            </h2>
        </div>
    </div>
</header>

<main class="content" role="main">
    

	<div class="extra-pagination inner">
    <nav class="pagination" role="navigation">
	
	<span class="page-number">Page 1 of 3</span>
	
	    <a class="older-posts" href="http://liushengxian.github.io/post/page/2/">Older Posts &rarr;</a>
	
</nav>

	</div>

	
	   
<article class="post post">
    <header class="post-header">
        <h2 class="post-title"><a href="http://liushengxian.github.io/post/two-bugs-in-work/">记录工作中遇到的两个bug</a></h2>
    </header>
    <section class="post-excerpt">
        <p>很久没有写blog了。这次在工作中遇到两个bug，更新一下。
生产环境与开发环境不一致的问题 在上线几个新功能之后，突然QA反馈线上的某个页面的switch按钮不见了。当然，因为程序具有默认行为，所以这几个按钮不见倒也没有太多的用户反馈。
因为可能在用户看来这个页面本来就是不能做更多控制的。所以我有足够的时间来找出问题的所在。
在尝试了多次改动之后，发现这个switch按钮在开发环境&amp;测试环境都能看到。但是一到了beta环境或者线上生产环境之后，就还是莫名其妙的失踪了。在线上的console里面甚至看不到任何有用的报错信息。。只有一个奇怪的没有任何提示的红色Error。
用Chrome的console指针点击页面后，发现按钮组件的dom根本没有生成，而是一个类似于v-if=&ldquo;false&quot;情况下的
&lt;!-- --&gt; 我开始怀疑是否组件没有正确传入参数，并尝试了几次修改控制组件展示的变量，但是都没有成功，仍旧是在开发环境生龙活虎，在线上、beta消失不见。
在咨询浩洋哥之后，他提出可以让运维看一下是否发布了正确的版本。
但是我对比了自己push上去的代码的hash值与CI中build的hash值，却是一样的，说明发布环境没有什么问题。
就在我百思不得其解的时候，我在beta环境上看到了一个错误提示。应该也就是线上那个被过滤掉的错误提示信息。
大概意思是说，true不能作为值 赋值给onClick。
恍然大悟，想到自己在这个组件里看到的on={true}这个选项。意识到这里的on被某个插件（怀疑是升级过后的babel插件、或者typescript插件）自动识别成了onClick。然后将布尔值赋给onClick，自然会无法赋值成功，然后导致运行时错误，dom也就无法顺利渲染出来了。
将on这个属性改为switch之后，上beta，果然，问题解决了。
启发 首先这个坑是前面人留下来的，用on来作为一个标志记录组件的状态属实是有些问题的。一般朋友命名时应该都不会用这么简单的名称来写到dom属性上面去吧。
其次，对我的启发是，自己对代码打包过程的理解还是不足的。如果能够知道每个依赖都做了什么的话，也许在一开始从线上/线下环境不一致就应该考虑到是打包工具的问题。继而寻找代码中有哪些地方做的不够规范。
vue-router中replace方法失效的问题 第二个问题更加让人头疼。搞了一天才总算搞定。
当前负责的这个项目中，vue-router的replace方法莫名失效了。结果导致在很多机型上面，操作应用之后各种页面都push进history栈当中。在返回的时候，会有很多之前的页面，返回半天才能返回到应用的入口。
前面的项目负责人为了解决这个问题，在程序中用了hack的方法，监听页面左上角的返回按钮，在返回到首页的时候，点击返回按钮直接关闭应用。而我也做了一个优化，就是用客户端同事提供的sdk，监听了返回事件，进行页面的跳转。
但是这个方法也有其无法处理的问题。就是在iOS的机型上面，左滑返回上一页是不在返回事件控制的范畴之内的。导致在iOS上面左滑很多次都有奇怪的页面，很多次才能退出应用。当然一直使用push也会导致应用算占据的内存不断膨胀，也许在操作多次之后就会crash（未验证是否keep-alive会有助于解决这个情况）
所以我就着手开始解决这个问题。
其实问题一开始发现也是QA这边发现的，反馈的问题是我们上线新代码之后频繁出现了这个问题（这个问题QA同学一直有遇到过，但是这几次上线之后特别频繁，稳定复现）。
第一个发现的问题就是，在应用首页多个tab中，之前的开发使用了$router.replace()来记录首页多个tab的变化。当我把这个$router.replace()去掉之后，应用正常切换tab，且观察到浏览器当中的history栈不再增加。
理论上使用replace来做这种事情是没有问题的。但是在这个replace不生效，莫名变成push的情况下，就变得很糟糕。可以通过快速点击首页的tab实现生成爆炸长度的history。
当我搜索项目后，发现这个replace主要是提供了一个新的query，叫做tabIndex的值，给另外仅有的一个地方使用。这就让我很放心了，其实这种在app内的应用，完全可以不需要这种地址，反正每次进入都是首页，而且切换tab的事情完全可以放到vuex当中存储。没必要放到路由当中，如果实在不行，就把首页的这个replace撤掉，然后改写一下那仅有的一个地方好了。
但是问题没有那么简单，虽然这个tabIndex只有一个地方使用，但使用$router.replace()的地方可不止一处，而且很多地方都是不可替换的。
那么我们继续调查为什么这个router.replace()失败了呢。当我回归到vue-router的文档时，发现replace方法的第二个、第三个参数可以分别设置为replace成功与失败的回调。当然也可以不设置，这样replace返回的是一个promise，可以使用then，catch语句进行捕获结果/错误。
心想这样总可以找到问题了吧。然后用了回调&amp;catch语句发现，的确是跳转路由失败了，但却没有返回值。（笔者用的vue-router版本不是最新的，最新的代码已经添加了这个报错信息）
返回的报错值是undefined，就很让人头大，不知道问题出在哪里。
尝试了一下replaceState方法，发现在使用这个方法的时候，能够正确地更新history历史。实在不行我就把所有的$router.replace()都替换成history.replaceState()吧。我这么想着。
回头去看vue-router的文档，发现有一个replace选项，甚至在网上查到尤大在0.x版本的github issue上面跟网友探讨是否replace的默认值设置为true会更好一些。抱着试一试的心态我给项目中所有replace方法添加了replace： true。
果不其然，没有任何用处。
没办法，只能硬着头皮去看vue-router的源码了。使用debugger开始单步调试，看了大半天，也没发现什么问题。看到不知道几层的代码逻辑之后，连自己也绕晕了。不想再读下去了。
心想，难道真的升级下vue-router的版本就可以了？于是自己抱着怀疑的态度，去随便搜索了一个公司内的其他项目，确认了代码中也使用了replace方法，然后发现不论是公司的脚手架，还是vue-router的版本，都是一样的。
果然，问题不出在vue-router或者脚手架的版本上面。前面已经翻过脚手架的CHANGELOG，根本没有发现有什么修复vue-router相关的问题。在网上搜索也找不到相同的情况。
只好无奈地继续翻vue-router的源码，单步调试看问题出在哪里。嗯，，vue-router最后会生成一个队列，然后把所有钩子函数都执行一遍，然后跳到了一个方法当中去，根据这个方法中的to.replace来看是需要使用push还是replace方法。等等。。？这个to是哪里来的？不是replace方法中的replace选项，那是哪里来的？看着单步调试中，栈在处理完队列的时候，history的长度又增加了1，就觉得莫名忧伤。
就在这时，我找不到原因的时候，又看到了自己之前尝试的replaceState()的代码，在浏览器中尝试，突然发现自己页面上面虽然能够跳转成功，但是页面的query中携带的用户信息&amp;其他query都不见了。
这就让我想起之前看到的项目中，两年前项目开始的时候就已经添加上的那个写给vue的插件了。这个插件添加了一个beforeRoute钩子，在钩子中，保留了需要保存的query信息。我想如果要用replaceState来做的话，也要看下怎么兼容这个方案吧。
打开plugin的文件的时候，突然一道灵光闪过，我意识到问题所在了。
！！！！！！
就是这个plugin在它的钩子里使用next()方法修改url的时候，没有使用replace参数！导致每次$router.replace()都会新增一个页面到history栈当中去！
在给next方法添加了replace：true选项之后，反复试了几次，发现果然history在$router.replace()的时候不再增加了。
我解决了一个两年前的bug！
启发 谁也不曾想到，这个问题居然会是这样引起的。
反思自己一步步来debug的过程，可以看到自己对vue-router的原理一步步加深，但是还是没有完全吃透。
所以，还是努力把vue-router的源码搞清楚吧。这样再次遇到类似的问题时候，就会更快定位到问题所在。
再一个启发就是，vue-router已经经历了社区的验证，其实不需要花费过多时间在找它的问题上面，而应该将问题聚焦于自己的业务代码上面。毕竟其他使用vue-router的项目，都没有遇到这个奇葩的问题。所以问题更大可能性是出在我们自己的业务代码/项目自有的框架上面。
最后 晚安！ 好好休息，保持好状态，不要过分熬夜！就算进度赶不上，也不要太过着急了！ <a class="read-more" href="http://liushengxian.github.io/post/two-bugs-in-work/">&raquo;</a></p>
    </section>
    <footer class="post-meta">
        
        

        
            <img class="author-thumb" src="http://liushengxian.github.io/images/home.png" alt="Author image" nopin="nopin" />
        
        
            Misanya Liu
        
        
        <time class="post-date" datetime="2020-11-11T01:23:08&#43;08:00">
            11 Nov 2020
        </time>
    </footer>
</article>

	
	   
<article class="post post">
    <header class="post-header">
        <h2 class="post-title"><a href="http://liushengxian.github.io/post/project_gutenburg/">《无双》观后感</a></h2>
    </header>
    <section class="post-excerpt">
        <p>昨天跟果果一起约好了小聚一下，翻了翻最近档期的电影，发现只有《无双》的评分还是蛮高的，于是下午就一起欣赏了一波。
可以说，这是一部高智商犯罪片。作为男主角的“画家”（也即李问），以及作为女主角的秀清，可以说都是智商超高的人物。让我想起的另一个角色就是《越狱》里的Micheal Scofield。画家有着制造伪钞的技术，搞清楚了所有的技术难点，有着超强的记忆力和绘画水平，以及超一流的编剧、表演水平。想想自己的水平，高智商犯罪，算了还是好好当老实人吧。真的存在这样的人的话，那可真是我完全没法想象的生活。
P.S. 当时怎么自己没有选择印钞相关的专业呢。
讲故事一开始的时候我就在想，这大概是第二代或者第三代华人吧？要是刚搬过去的留学生，大概率家里条件不会这么差，而且学艺术的话，我觉得在西方应该大概率都是富有阶级才能够去做的事情。至少在中国，上一代从饥饿的时代过来，不会去冒险做这种事。（果然，全是李问编的）
片子中场的时候，我想到，这都回忆了快一个小时了。怎么还没去抓呢？到五点钟就散场了，还不到一小时，要是去抓画家，时间也太紧凑了吧？
所以让人惊喜的，真的在最后二十分钟，故事剧情峰回路转。我们发现之前的很多都是李问假造或者改造的故事。
难道李问就这么跑了？戏耍了日常没用的警察，然后保释成功出来了？不行，这不符合社会主义核心价值观。所以最后，还是有那么一出爆炸。
这却也是人物性格的悲剧。就算从卑微的人物成为叱咤风云的伪钞罪犯。自身的那些缺点却从来没有改变过。最后几个送命题，耿直的回答，真的是让李问送了命。站在男人角度想，千万不要KY（读不懂氛围），尤其是那些关键时刻。但是从秀清的角度来想，有这么样的回答，也真是绝望。最后的选择，也真是最好的结局。
到最后，警察到大西北找到真正的阮文的时候。一句，“他是我那个时候的邻居”，让人觉得辛酸不已。作为一个有过类似心理感受的人而言，可以说是秒懂了李问的心思。却不得不说，这种偏执，我是做不到的。回忆里一直对他吼着，要做一百万个人里的主角的那个“发哥”，其实只是自己被压抑、被鑫叔说只能做小角色的反抗。“放弃爱情的男人，什么事情都做不成。”我从心底里是佩服这句话的。但是到最后，其实阮文根本没有认识过这个男人。这是多么卑微的爱慕啊。如果换做是我，也许，不，我一定会放弃这个。所谓“重温旧梦就是破坏旧梦”，不如就让那美好的想象一直存在于自己的心里好了，甚至是忘掉。
而李问的绰号为什么叫画家？李问从来不是一个画家，而阮文是。
让我觉得好奇的是，是什么让他追逐成为主角？那种偏执，在我身上可以说是没有。那种在球场上追求胜利、在技术上追求极致的精神，也是被我舍弃掉了。我没有这种偏执，却十分能理解他们。这是李问之所以能成为李问的关键要素，却也是他始终不能放下，好好享受生活的根源。
我想，能够成为这样的英雄，也不错了。
而我的朋友们，我们还是好好珍惜眼下的幸福，一起欢笑，一起潇潇洒洒地生活吧。 <a class="read-more" href="http://liushengxian.github.io/post/project_gutenburg/">&raquo;</a></p>
    </section>
    <footer class="post-meta">
        
        

        
            <img class="author-thumb" src="http://liushengxian.github.io/images/home.png" alt="Author image" nopin="nopin" />
        
        
            Misanya Liu
        
        
        <time class="post-date" datetime="2018-10-14T18:17:30&#43;08:00">
            14 Oct 2018
        </time>
    </footer>
</article>

	
	   
<article class="post post">
    <header class="post-header">
        <h2 class="post-title"><a href="http://liushengxian.github.io/post/save_you_linux_system/">拯救你的ubuntu</a></h2>
    </header>
    <section class="post-excerpt">
        <p>在给大金鱼的ubuntu添加gulp相关的环境变量时候，因为看了不正确的教程。把/opt/profile里的内容修改了，导致无法进入系统。登录界面输入正确密码反复卡在登录界面。
折腾了许久，发现了解决方案： 在启动系统的时候长按shift，进入Linux的Recovery Mode，但是，这个mode下面却无法修改文件。在grub选择Recovery Mode的时候按E，编辑启动文件来修改启动方式。
将 ro recovery nomodeset 改为 rw single init=/bin/bash
参考资料：recovery mode <a class="read-more" href="http://liushengxian.github.io/post/save_you_linux_system/">&raquo;</a></p>
    </section>
    <footer class="post-meta">
        
        

        
            <img class="author-thumb" src="http://liushengxian.github.io/images/home.png" alt="Author image" nopin="nopin" />
        
        
            Misanya Liu
        
        
        <time class="post-date" datetime="2018-03-08T11:19:14&#43;08:00">
            8 Mar 2018
        </time>
    </footer>
</article>

	
	   
<article class="post post">
    <header class="post-header">
        <h2 class="post-title"><a href="http://liushengxian.github.io/post/saygoodbye_2017/">再见我的2017年</a></h2>
    </header>
    <section class="post-excerpt">
        <p>通常来说，都认为人在本命年会过得比较坎坷一些。(至少某人是这么认为的吧。)
再见我的2017 甚至有些平淡地不够真实。
我想我的问题还是在于有的时候没有去考虑，不自觉地在逃避某些东西。
有些东西，其实自己知道应该要做什么。但是当有时间的时候，却麻木————或者，我也找不到太好的词————不太想做事情。
每个人都有自己的苦恼。
恐惧 仔细思考下，觉得自己仿佛一直都只是在原地徘徊。从大二下挂科开始，之后虽然自己再也没有挂科，可是却再也没有进入状态。那种巅峰体验，退潮了。我已经很久没有体验过了。其实在玩游戏的时候偶尔有体验过。
有时候很害怕，因为自己的未来。假使自己是努力，尽力还是不能达到某种程度。那好像。。好像也是另一种伤心。但是，目前对我来说，比现在给我带来的这种体验，也许会好一些吧？
做得好 细数自己做的好的方面，好像都没有什么。就拿游戏方面来说，我好像玩的蛮多的，但是都没有那么好。LOL，也就黄金守门员的水平。DNF，早就弃坑了。炉石传说，冲冲钱在20级虐虐小朋友，传说，不存在的，竞技场更是经常2-3胜出局。王者荣耀倒是，玩了快400把终于上了个钻石。这个游戏钻石水分很大就不用说了。射击类游戏，玩的蛮多的，就不用多说了，玩不了。那些氪或者肝的，对不起，玩不起。什么崩坏2，舰N。LoveLive的，也就刷刷hard难度的，当一条咸鱼了。
完 这边文章写的时候心里有点潮湿，但是写着写着也觉得释然了。文章没有写完，但是到现在，已经没有要继续这个话题写下去的想法了。说完了。
关于生病 最近我养的猴子生病了。已经歇了三天。 <a class="read-more" href="http://liushengxian.github.io/post/saygoodbye_2017/">&raquo;</a></p>
    </section>
    <footer class="post-meta">
        
        

        
            <img class="author-thumb" src="http://liushengxian.github.io/images/home.png" alt="Author image" nopin="nopin" />
        
        
            Misanya Liu
        
        
        <time class="post-date" datetime="2017-12-27T23:47:07&#43;08:00">
            27 Dec 2017
        </time>
    </footer>
</article>

	
	   
<article class="post post">
    <header class="post-header">
        <h2 class="post-title"><a href="http://liushengxian.github.io/post/my_way_to_config_work_project/">配置我的工作项目</a></h2>
    </header>
    <section class="post-excerpt">
        <p>配置工作项目的过程 鶸米一共花了整整三天晚上才把环境配好。期间记录了自己到底干了什么。下面梳理下配置流程。
Day 1 0.安装Mint。用公司的那个安装盘安装的。然后参考[这里][ref-1]。 [ref-1]: http://blog.csdn.net/albertjone/article/details/54633747
1.download netease music for linux; 下载网易云音乐。没有小姐姐的歌声自己在这里折腾系统简直熬不下去。【手动滑稽】
2.download hardware from startup panel; 因为下载了播放器但还是没有声音。很郁闷，所以尝试装下驱动。然而并没有什么卵用。
3.sudo apt-get update/sudo apt-get upgrade [upgrade is breaking here.] 按照上面那个链接里的文章，尝试这两个命令。前面的OK了 但是upgrade总是会中断。
4.download chrome for linux; wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb sudo gdebi google-chrome-stable_current_amd64.deb 下载Chrome浏览器。Linux上的Firefox有时候跟Windows的IE的命运是一样的。
5.no sound: changing into the back plug.(Mint 18)(Someone told me to upgrade linux kernel!) 还是没有声音，但是调了半天之后发现都没有问题。后来我把耳机从前面的孔插到后面的孔就好了【=。=】
6.install git. 安装Git。
7.generate my ssh-key for github. 生成本机的SSH-KEY。多台机器其实可以使用相同的KEY。但是这里还是新生成了。
8.download shadowsocks-qt5. 装了半天想要google下一些问题 但是发现没有翻墙。于是这里开了小插曲。自己搭了个翻墙服务。
https://github.com/shadowsocks/shadowsocks-qt5/wiki (sudo add-apt-repository ppa:hzwhuang/ss-qt5 sudo apt-get update sudo apt-get install shadowsocks-qt5) <a class="read-more" href="http://liushengxian.github.io/post/my_way_to_config_work_project/">&raquo;</a></p>
    </section>
    <footer class="post-meta">
        
        

        
            <img class="author-thumb" src="http://liushengxian.github.io/images/home.png" alt="Author image" nopin="nopin" />
        
        
            Misanya Liu
        
        
        <time class="post-date" datetime="2017-05-04T23:49:00&#43;08:00">
            4 May 2017
        </time>
    </footer>
</article>

	

	<nav class="pagination" role="navigation">
	
	<span class="page-number">Page 1 of 3</span>
	
	    <a class="older-posts" href="http://liushengxian.github.io/post/page/2/">Older Posts &rarr;</a>
	
</nav>

</main>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Misanya&#39;s Blog</a> All rights reserved - 2016</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="http://liushengxian.github.io/js/jquery.js"></script>
    <script type="text/javascript" src="http://liushengxian.github.io/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="http://liushengxian.github.io/js/index.js"></script>
    <script type="text/javascript" src="http://liushengxian.github.io/js/jquery.dotdotdot.min.js"></script>
    
</body>
</html>
